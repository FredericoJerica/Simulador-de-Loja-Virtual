<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - FreOde</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="estiloAdmin.css">
</head>
<body>

    <header>
        <div class="container header-content">
            <div class="logo">
                <span class="logo-icon">üõí</span>
                <span>FreOde Admin</span>
            </div>
        </div>
    </header>

    <div id="login-area">
        <div class="login-container">
            <h2>Acesso Administrativo</h2>
            <form id="form-login">
                <div class="form-group">
                    <label for="usuario">Usu√°rio</label>
                    <input type="text" id="usuario" required>
                </div>
                <div class="form-group">
                    <label for="senha">Senha</label>
                    <input type="password" id="senha" required>
                </div>
                <button type="submit" class="btn-login">Entrar</button>
                <div id="mensagem-erro" class="mensagem-erro">Usu√°rio ou senha incorretos!</div>
            </form>
        </div>
    </div>

    <div id="admin-area" style="display: none;">
        <div class="admin-container">
            <div class="admin-header">
                <h2>Painel Administrativo</h2>
                <a href="index.html" class="btn-voltar">‚Üê Voltar √† Loja</a>
            </div>
            
            <div class="admin-layout">
                <!-- Menu Lateral -->
                <div class="admin-sidebar">
                    <div class="sidebar-header">
                        <h3>Menu</h3>
                    </div>
                    <nav class="sidebar-nav">
                        <button class="nav-item active" data-page="dashboard">
                            üìä Dashboard
                        </button>
                        <button class="nav-item" data-page="cadastrar">
                            ‚ûï Cadastrar Produto
                        </button>
                        <button class="nav-item" data-page="gerenciar">
                            üìã Gerenciar Produtos
                        </button>
                    </nav>
                    <div class="sidebar-footer">
                        <button id="btn-logout" class="btn-logout">
                            üö™ Sair
                        </button>
                    </div>
                </div>
                
                <!-- Conte√∫do Principal -->
                <div class="admin-main">
                    <!-- P√°gina Dashboard -->
                    <div id="page-dashboard" class="admin-page active">
                        <div class="page-header">
                            <h3>üìä Dashboard</h3>
                            <p>An√°lise e estat√≠sticas dos produtos</p>
                        </div>
                        
                        <!-- Cards de Resumo -->
                        <div class="resumo-cards">
                            <div class="resumo-card">
                                <h4>Total de Produtos</h4>
                                <p class="resumo-numero" id="total-produtos-card">0</p>
                            </div>
                            <div class="resumo-card">
                                <h4>Estoque Total</h4>
                                <p class="resumo-numero" id="total-estoque">0</p>
                            </div>
                            <div class="resumo-card">
                                <h4>Valor Total em Estoque</h4>
                                <p class="resumo-numero" id="valor-total-estoque">0 kz</p>
                            </div>
                            <div class="resumo-card">
                                <h4>Categorias</h4>
                                <p class="resumo-numero" id="total-categorias">4</p>
                            </div>
                        </div>
                        
                        <!-- Gr√°ficos -->
                        <div class="graficos-container">
                            <div class="grafico-card">
                                <h4>Produtos por Categoria</h4>
                                <canvas id="grafico-categorias"></canvas>
                            </div>
                            <div class="grafico-card">
                                <h4>Estoque Total por Categoria</h4>
                                <canvas id="grafico-estoque"></canvas>
                            </div>
                            <div class="grafico-card">
                                <h4>Valor Total em Estoque (kz)</h4>
                                <canvas id="grafico-valor-estoque"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- P√°gina Cadastrar -->
                    <div id="page-cadastrar" class="admin-page">
                        <div class="page-header">
                            <h3>‚ûï Cadastrar Novo Produto</h3>
                            <p>Preencha os dados do novo produto</p>
                        </div>
                        
                        <div class="form-container">
                            <form id="formulario-admin">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="admin-nome">Nome do Produto</label>
                                        <input type="text" id="admin-nome" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="admin-preco">Pre√ßo (kz)</label>
                                        <input type="number" id="admin-preco" step="0.01" min="0" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="admin-estoque">Estoque Dispon√≠vel</label>
                                        <input type="number" id="admin-estoque" min="0" required>
                                        <small>Quantidade dispon√≠vel em estoque</small>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="admin-categoria">Categoria</label>
                                        <select id="admin-categoria" required>
                                            <option value="">Selecione...</option>
                                            <option value="eletronicos">Eletr√¥nicos</option>
                                            <option value="vestuario">Vestu√°rio</option>
                                            <option value="livros">Livros</option>
                                            <option value="moveis">M√≥veis</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group full-width">
                                        <label for="admin-imagem">Imagem do Produto</label>
                                        <div class="imagem-upload">
                                            <input type="file" id="admin-imagem" accept="image/*" required>
                                            <small>Use imagens quadradas para melhor visualiza√ß√£o</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn-submit">Cadastrar Produto</button>
                                    <button type="button" class="btn-limpar" id="btn-limpar">Limpar Formul√°rio</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- P√°gina Gerenciar -->
                    <div id="page-gerenciar" class="admin-page">
                        <div class="page-header">
                            <h3>üìã Gerenciar Produtos</h3>
                            <p>Visualize, edite ou elimine produtos cadastrados</p>
                        </div>
                        
                        <div class="filtros">
                            <div class="search-box">
                                <input type="text" id="search-input" placeholder="Buscar produto...">
                                <button class="btn-search">üîç</button>
                            </div>
                            <select id="filter-categoria" class="filter-select">
                                <option value="">Todas as categorias</option>
                                <option value="eletronicos">Eletr√¥nicos</option>
                                <option value="vestuario">Vestu√°rio</option>
                                <option value="livros">Livros</option>
                                <option value="moveis">M√≥veis</option>
                            </select>
                        </div>
                        
                        <div class="produtos-info">
                            <p>Total de produtos: <span id="total-produtos">0</span></p>
                            <p>Produtos filtrados: <span id="produtos-filtrados">0</span></p>
                        </div>
                        
                        <div class="produtos-lista" id="lista-produtos">
                            <!-- Produtos ser√£o listados aqui -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Edi√ß√£o -->
    <div id="modal-edicao" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3>Editar Produto</h3>
                <button class="btn-fechar">&times;</button>
            </div>
            <form id="form-editar">
                <input type="hidden" id="editar-id">
                
                <div class="form-group">
                    <label for="editar-nome">Nome do Produto</label>
                    <input type="text" id="editar-nome" required>
                </div>
                
                <div class="form-group">
                    <label for="editar-preco">Pre√ßo (kz)</label>
                    <input type="number" id="editar-preco" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="editar-estoque">Estoque Dispon√≠vel</label>
                    <input type="number" id="editar-estoque" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="editar-categoria">Categoria</label>
                    <select id="editar-categoria" required>
                        <option value="">Selecione...</option>
                        <option value="eletronicos">Eletr√¥nicos</option>
                        <option value="vestuario">Vestu√°rio</option>
                        <option value="livros">Livros</option>
                        <option value="moveis">M√≥veis</option>
                    </select>
                </div>
                
                <div class="imagem-preview-container">
                    <p style="margin-bottom: 10px; font-weight: 600; color: #2c3e50;">Imagem atual:</p>
                    <img id="imagem-atual" class="imagem-preview" src="" alt="Imagem do produto">
                    <button type="button" class="btn-trocar-imagem" id="btn-trocar-imagem">
                        Trocar Imagem
                    </button>
                    <input type="file" id="nova-imagem" accept="image/*" style="display: none;">
                </div>
                
                <div class="modal-actions">
                    <button type="submit" class="btn-salvar">Salvar Altera√ß√µes</button>
                    <button type="button" class="btn-cancelar" onclick="fecharModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Credenciais de acesso
        const USUARIO_ADMIN = "admin";
        const SENHA_ADMIN = "admin123";
        
        // Verificar se est√° logado
        let usuarioLogado = localStorage.getItem('admin_logado') === 'true';
        
        // Elementos
        const loginArea = document.getElementById('login-area');
        const adminArea = document.getElementById('admin-area');
        const formLogin = document.getElementById('form-login');
        const mensagemErro = document.getElementById('mensagem-erro');
        
        // Modal de edi√ß√£o
        const modalEdicao = document.getElementById('modal-edicao');
        const btnFecharModal = document.querySelector('.btn-fechar');
        const formEditar = document.getElementById('form-editar');
        const btnTrocarImagem = document.getElementById('btn-trocar-imagem');
        const inputNovaImagem = document.getElementById('nova-imagem');
        const imagemAtual = document.getElementById('imagem-atual');
        
        // Vari√°veis globais
        let produtos = JSON.parse(localStorage.getItem('produtos')) || [];
        let produtoEditando = null;
        let novaImagemSelecionada = false;
        let graficos = {};
        
        // Inicializar p√°gina
        if (usuarioLogado) {
            mostrarAreaAdmin();
        } else {
            mostrarAreaLogin();
        }
        
        // Evento de login
        formLogin.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const usuario = document.getElementById('usuario').value;
            const senha = document.getElementById('senha').value;
            
            if (usuario === USUARIO_ADMIN && senha === SENHA_ADMIN) {
                // Login bem-sucedido
                localStorage.setItem('admin_logado', 'true');
                usuarioLogado = true;
                mostrarAreaAdmin();
                carregarProdutos();
                carregarResumo();
                inicializarNavegacao();
            } else {
                // Login falhou
                mensagemErro.style.display = 'block';
                setTimeout(() => {
                    mensagemErro.style.display = 'none';
                }, 3000);
            }
        });
        
        // Logout autom√°tico ap√≥s 30 minutos
        setTimeout(() => {
            if (usuarioLogado) {
                localStorage.removeItem('admin_logado');
                alert('Sess√£o expirada. Por favor, fa√ßa login novamente.');
                window.location.reload();
            }
        }, 30 * 60 * 1000);
        
        function mostrarAreaLogin() {
            loginArea.style.display = 'block';
            adminArea.style.display = 'none';
        }
        
        function mostrarAreaAdmin() {
            loginArea.style.display = 'none';
            adminArea.style.display = 'block';
        }
        
        // ==================== FUN√á√ïES DE NAVEGA√á√ÉO ====================
        function inicializarNavegacao() {
            // Bot√µes do menu
            document.querySelectorAll('.nav-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remove classe active de todos
                    document.querySelectorAll('.nav-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    document.querySelectorAll('.admin-page').forEach(page => {
                        page.classList.remove('active');
                    });
                    
                    // Adiciona classe active no bot√£o clicado
                    this.classList.add('active');
                    
                    // Mostra a p√°gina correspondente
                    const pageId = this.getAttribute('data-page');
                    document.getElementById(`page-${pageId}`).classList.add('active');
                    
                    // Se for dashboard, atualiza gr√°ficos
                    if (pageId === 'dashboard') {
                        criarGraficos();
                    }
                });
            });
            
            // Bot√£o de logout
            document.getElementById('btn-logout').addEventListener('click', function() {
                localStorage.removeItem('admin_logado');
                window.location.reload();
            });
            
            // Bot√£o limpar formul√°rio
            document.getElementById('btn-limpar')?.addEventListener('click', function() {
                document.getElementById('admin-nome').value = '';
                document.getElementById('admin-preco').value = '';
                document.getElementById('admin-estoque').value = '';
                document.getElementById('admin-categoria').value = '';
                document.getElementById('admin-imagem').value = '';
            });
            
            // Filtro de busca
            document.getElementById('search-input')?.addEventListener('input', function() {
                filtrarProdutos();
            });
            
            // Filtro por categoria
            document.getElementById('filter-categoria')?.addEventListener('change', function() {
                filtrarProdutos();
            });
        }
        
        // ==================== FUN√á√ïES DE PRODUTOS ====================
        function salvarProdutos() {
            localStorage.setItem('produtos', JSON.stringify(produtos));
        }
        
        function formatarPreco(preco) {
            return `${preco.toFixed(2).replace('.', ',')} kz`;
        }
        
        function carregarResumo() {
            // Calcular totais
            const totalProdutos = produtos.length;
            const totalEstoque = produtos.reduce((sum, prod) => sum + prod.estoque, 0);
            const valorTotalEstoque = produtos.reduce((sum, prod) => sum + (prod.preco * prod.estoque), 0);
            
            // Atualizar cards
            document.getElementById('total-produtos-card').textContent = totalProdutos;
            document.getElementById('total-estoque').textContent = totalEstoque;
            document.getElementById('valor-total-estoque').textContent = formatarPreco(valorTotalEstoque);
        }
        
        function filtrarProdutos() {
            const termo = document.getElementById('search-input').value.toLowerCase();
            const categoria = document.getElementById('filter-categoria').value;
            
            const produtosFiltrados = produtos.filter(produto => {
                const matchNome = produto.nome.toLowerCase().includes(termo);
                const matchCategoria = !categoria || produto.categoria === categoria;
                return matchNome && matchCategoria;
            });
            
            // Atualizar contador
            document.getElementById('produtos-filtrados').textContent = produtosFiltrados.length;
            
            // Renderizar produtos filtrados
            renderizarProdutos(produtosFiltrados);
        }
        
        function renderizarProdutos(listaProdutos) {
            const lista = document.getElementById('lista-produtos');
            
            if (listaProdutos.length === 0) {
                lista.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #666;">
                        <p>Nenhum produto encontrado.</p>
                        <p>Tente alterar os filtros de busca.</p>
                    </div>
                `;
                return;
            }
            
            // Renderiza lista de produtos
            lista.innerHTML = '';
            listaProdutos.forEach((produto, index) => {
                const item = document.createElement('div');
                item.className = 'produto-admin-item';
                item.innerHTML = `
                    <div class="produto-info">
                        <div class="produto-imagem-small">
                            <img src="${produto.imagem}" alt="${produto.nome}">
                        </div>
                        <div class="produto-detalhes">
                            <h4>${produto.nome}</h4>
                            <p>${formatarPreco(produto.preco)} ‚Ä¢ Estoque: ${produto.estoque}</p>
                            <p><small>Categoria: ${produto.categoria}</small></p>
                        </div>
                    </div>
                    <div class="produto-admin-botoes">
                        <button class="btn-editar" data-id="${produto.id}">
                            Editar
                        </button>
                        <button class="btn-eliminar" data-id="${produto.id}">
                            Eliminar
                        </button>
                    </div>
                `;
                lista.appendChild(item);
            });
        }
        
        function carregarProdutos() {
            // Atualizar contadores
            document.getElementById('total-produtos').textContent = produtos.length;
            document.getElementById('produtos-filtrados').textContent = produtos.length;
            
            // Carregar resumo
            carregarResumo();
            
            // Renderizar produtos
            renderizarProdutos(produtos);
            
            // Criar gr√°ficos
            if (usuarioLogado && produtos.length > 0) {
                criarGraficos();
            }
        }
        
        // Cadastrar produto
        document.getElementById('formulario-admin').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const nome = document.getElementById('admin-nome').value;
            const preco = parseFloat(document.getElementById('admin-preco').value);
            const estoque = parseInt(document.getElementById('admin-estoque').value);
            const categoria = document.getElementById('admin-categoria').value;
            const inputImagem = document.getElementById('admin-imagem');
            
            // Valida√ß√£o
            if (!nome || !preco || isNaN(estoque) || !categoria || inputImagem.files.length === 0) {
                alert('Preencha todos os campos corretamente!');
                return;
            }
            
            if (preco <= 0) {
                alert('O pre√ßo deve ser maior que zero!');
                return;
            }
            
            if (estoque < 0) {
                alert('O estoque n√£o pode ser negativo!');
                return;
            }
            
            const arquivo = inputImagem.files[0];
            const leitor = new FileReader();
            
            leitor.onload = function(e) {
                const novoProduto = {
                    id: Date.now(),
                    nome: nome,
                    preco: preco,
                    categoria: categoria,
                    estoque: estoque,
                    imagem: e.target.result
                };
                
                produtos.push(novoProduto);
                salvarProdutos();
                
                // Atualiza interface
                carregarProdutos();
                
                // Limpa formul√°rio
                document.getElementById('admin-nome').value = '';
                document.getElementById('admin-preco').value = '';
                document.getElementById('admin-estoque').value = '';
                document.getElementById('admin-categoria').value = '';
                document.getElementById('admin-imagem').value = '';
                
                alert(`‚úÖ Produto "${nome}" cadastrado com sucesso!`);
                
                // Vai para a p√°gina de gerenciar
                document.querySelector('[data-page="gerenciar"]').click();
            };
            
            leitor.readAsDataURL(arquivo);
        });
        
        // ==================== FUN√á√ïES DE EDI√á√ÉO ====================
        function abrirModalEdicao(id) {
            produtoEditando = produtos.find(p => p.id === id);
            if (!produtoEditando) return;
            
            // Preencher formul√°rio com dados atuais
            document.getElementById('editar-id').value = produtoEditando.id;
            document.getElementById('editar-nome').value = produtoEditando.nome;
            document.getElementById('editar-preco').value = produtoEditando.preco;
            document.getElementById('editar-estoque').value = produtoEditando.estoque;
            document.getElementById('editar-categoria').value = produtoEditando.categoria;
            imagemAtual.src = produtoEditando.imagem;
            
            // Resetar controle de nova imagem
            novaImagemSelecionada = false;
            inputNovaImagem.value = '';
            
            // Mostrar modal
            modalEdicao.style.display = 'flex';
        }
        
        function fecharModal() {
            modalEdicao.style.display = 'none';
            produtoEditando = null;
            novaImagemSelecionada = false;
        }
        
        // Eventos do modal
        btnFecharModal.addEventListener('click', fecharModal);
        modalEdicao.addEventListener('click', function(e) {
            if (e.target === modalEdicao) {
                fecharModal();
            }
        });
        
        // Bot√£o para trocar imagem
        btnTrocarImagem.addEventListener('click', function() {
            inputNovaImagem.click();
        });
        
        // Selecionar nova imagem
        inputNovaImagem.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                novaImagemSelecionada = true;
                const leitor = new FileReader();
                leitor.onload = function(e) {
                    imagemAtual.src = e.target.result;
                };
                leitor.readAsDataURL(e.target.files[0]);
            }
        });
        
        // Salvar altera√ß√µes
        formEditar.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!produtoEditando) return;
            
            // Obter novos valores
            const novoNome = document.getElementById('editar-nome').value;
            const novoPreco = parseFloat(document.getElementById('editar-preco').value);
            const novoEstoque = parseInt(document.getElementById('editar-estoque').value);
            const novaCategoria = document.getElementById('editar-categoria').value;
            
            // Valida√ß√µes
            if (!novoNome || !novoPreco || isNaN(novoEstoque) || !novaCategoria) {
                alert('Preencha todos os campos corretamente!');
                return;
            }
            
            if (novoPreco <= 0) {
                alert('O pre√ßo deve ser maior que zero!');
                return;
            }
            
            if (novoEstoque < 0) {
                alert('O estoque n√£o pode ser negativo!');
                return;
            }
            
            // Atualizar produto
            const indice = produtos.findIndex(p => p.id === produtoEditando.id);
            
            if (indice !== -1) {
                // Atualizar dados b√°sicos
                produtos[indice].nome = novoNome;
                produtos[indice].preco = novoPreco;
                produtos[indice].estoque = novoEstoque;
                produtos[indice].categoria = novaCategoria;
                
                // Atualizar imagem se foi selecionada uma nova
                if (novaImagemSelecionada && inputNovaImagem.files[0]) {
                    const leitor = new FileReader();
                    leitor.onload = function(e) {
                        produtos[indice].imagem = e.target.result;
                        salvarProdutos();
                        carregarProdutos();
                        fecharModal();
                        alert(`‚úÖ Produto "${novoNome}" atualizado com sucesso!`);
                    };
                    leitor.readAsDataURL(inputNovaImagem.files[0]);
                } else {
                    salvarProdutos();
                    carregarProdutos();
                    fecharModal();
                    alert(`‚úÖ Produto "${novoNome}" atualizado com sucesso!`);
                }
            }
        });
        
        // Eventos de clique
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('btn-eliminar')) {
                const id = parseInt(e.target.getAttribute('data-id'));
                
                if (confirm('Tem certeza que deseja eliminar este produto?\nEsta a√ß√£o n√£o pode ser desfeita.')) {
                    // Remove o produto
                    produtos = produtos.filter(p => p.id !== id);
                    salvarProdutos();
                    
                    // Recarrega a lista
                    carregarProdutos();
                    
                    alert('Produto eliminado com sucesso!');
                }
            }
            
            // Evento para bot√£o de editar
            if (e.target.classList.contains('btn-editar')) {
                const id = parseInt(e.target.getAttribute('data-id'));
                abrirModalEdicao(id);
            }
        });
        
        // Carregar produtos quando a p√°gina admin for exibida
        if (usuarioLogado) {
            carregarProdutos();
        }

        // ==================== FUN√á√ïES DOS GR√ÅFICOS ====================
        function criarGraficos() {
            // Dados para os gr√°ficos
            const categorias = ['eletronicos', 'vestuario', 'livros', 'moveis'];
            const nomesCategorias = ['Eletr√¥nicos', 'Vestu√°rio', 'Livros', 'M√≥veis'];
            
            // Calcular dados
            const contagemPorCategoria = {};
            const estoquePorCategoria = {};
            const valorPorCategoria = {};
            
            categorias.forEach(cat => {
                contagemPorCategoria[cat] = 0;
                estoquePorCategoria[cat] = 0;
                valorPorCategoria[cat] = 0;
            });
            
            produtos.forEach(produto => {
                contagemPorCategoria[produto.categoria]++;
                estoquePorCategoria[produto.categoria] += produto.estoque;
                valorPorCategoria[produto.categoria] += produto.preco * produto.estoque;
            });
            
            // Destruir gr√°ficos anteriores se existirem
            Object.values(graficos).forEach(grafico => {
                if (grafico) grafico.destroy();
            });
            
            // 1. Gr√°fico de Produtos por Categoria (Pizza ou Doughnut)
            const ctxCategorias = document.getElementById('grafico-categorias');
            graficos.categorias = new Chart(ctxCategorias, {
                type: 'doughnut',
                data: {
                    labels: nomesCategorias,
                    datasets: [{
                        data: categorias.map(cat => contagemPorCategoria[cat]),
                        backgroundColor: [
                            '#FF6384', // eletronicos
                            '#36A2EB', // vestuario
                            '#FFCE56', // livros
                            '#4BC0C0'  // moveis
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // 2. Gr√°fico de Estoque por Categoria (Barras)
            const ctxEstoque = document.getElementById('grafico-estoque');
            graficos.estoque = new Chart(ctxEstoque, {
                type: 'bar',
                data: {
                    labels: nomesCategorias,
                    datasets: [{
                        label: 'Quantidade em Estoque',
                        data: categorias.map(cat => estoquePorCategoria[cat]),
                        backgroundColor: '#3498db',
                        borderColor: '#2980b9',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Quantidade'
                            }
                        }
                    }
                }
            });
            
            // 3. Gr√°fico de Valor Total em Estoque (Barras)
            const ctxValor = document.getElementById('grafico-valor-estoque');
            graficos.valor = new Chart(ctxValor, {
                type: 'bar',
                data: {
                    labels: nomesCategorias,
                    datasets: [{
                        label: 'Valor Total (kz)',
                        data: categorias.map(cat => valorPorCategoria[cat]),
                        backgroundColor: '#2ecc71',
                        borderColor: '#27ae60',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Valor (kz)'
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    // Formata o pre√ßo diretamente aqui
                                    const valor = context.raw;
                                    return `Valor: ${valor.toFixed(2).replace('.', ',')} kz`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function atualizarGraficos() {
            if (graficos.categorias) {
                criarGraficos(); // Recria todos os gr√°ficos
            }
        }

        // Verificar se DOM est√° carregado
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM carregado");
            
            // Se j√° estiver logado, inicializar navega√ß√£o
            if (usuarioLogado) {
                // Pequeno delay para garantir que o DOM est√° pronto
                setTimeout(function() {
                    inicializarNavegacao();
                }, 100);
            }
        });

    </script>
</body>
</html>